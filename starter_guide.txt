- setup EC2 instance in AWS with t2.micro (free tier)
- connect locally using ssh , use this : chmod 400 (instance name) in mac if read only issue persist


# Download Kafka within EC2 instance

- wget https://downloads.apache.org/kafka/4.0.1/kafka_2.13-4.0.1.tgz
- unizip : tar -xzf kafka_2.13-4.0.1.tgz

# Install compatible JVM:

sudo yum install -y java-17-amazon-corretto | # (Amazon Linux 2)


# Recent Kafka verion uses KRaft instead ZooKeeper 

# Create a cluster ID for KRaft: 

KAFKA_CLUSTER_ID="$(bin/kafka-storage.sh random-uuid)"
echo $KAFKA_CLUSTER_ID

# Point Kafka to its config directory and tell it to initialize KRaft metadata:

bin/kafka-storage.sh format -t $KAFKA_CLUSTER_ID -c config/kraft/server.properties

After checking this , lets finally spin up Kafka:

- bin/kafka-server-start.sh config/server.properties


# If the server doesn't start , follow the debugging technique:

open a new terminal window -> connect to EC2 using ssh -> cd to Kafka directory , then type:

-  nano bin/kafka-server-start.sh
- export KAFKA_HEAP_OPTS="-Xmx256M -Xms256M" # Replace line (29) with this
- Save and exit

# Also, Edit 
- nano config/server.properties
Replace the following contents:

process.roles=broker,controller
node.id=1
controller.quorum.voters=1@localhost:9093

controller.listener.names=CONTROLLER
listeners=PLAINTEXT://:9092,CONTROLLER://:9093

- save and exit
- format the storage 

run: KAFKA_CLUSTER_ID="$(bin/kafka-storage.sh random-uuid)"
bin/kafka-storage.sh format -t $KAFKA_CLUSTER_ID -c config/server.properties --standalone

- finally, restart your kafka again ...

STATUS 200: Kafka is running ...

